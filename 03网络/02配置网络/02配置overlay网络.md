# Overlay网络

## 大面儿

当网络无法感知工作负载的IP时，为工作负载之间建立通信机制。

## 价值

通常我们建议运行无overlay/封装的Calico。这样也是性能最好且最简单的网络；从你的工作负载中出来的数据包跟线路上传输的数据包保持完全一样。

但是吧，如果底层网络无法轻易感知到工作负载的IP，选择性的使用overlay/封装也是有意义的。一个常见的情况是在多VPC/子网的AWS中使用Calico网络。此时，Calico会选择性的为跨VPC/子网的流量进行封装，在每个VPC/子网内的流量则无需封装。你也可以选择让整个Calico网络都进行封装，弄成一整个overlay网络——在无需建立BGP对等或为底层网络添加路由信息的情况下快速入门。

## 特性

本文使用了以下特性：

**IPPool**资源：

- ipipMode字段（IP in IP封装）
- vxlanMode字段（VXLAN封装）

## 概念

### 路由工作负载的IP地址

网络感知工作负载的IP地址可以通过3层路由技术，例如静态路由或BGP路由分发，也可以通过2层地址学习。如此这般，它们就可以按照最终目的地的指示将流量路由到正确的主机上。但并不是所有的网络都可以路由工作负载的IP地址。

### 封装类型

### 跨子网