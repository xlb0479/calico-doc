# 保护主机教程

譬如说，Kubernetes集群的管理员现在想尽可能对外部进入到集群的流量进行加固。但是现在集群对外通过NodePort暴露了好多服务，端口的作用也都固定下来了，而且在每个节点上都是开放的。管理员现在想只暴露一部分NodePort到集群外。

本例中我们要为每个集群节点的外部接口设置pre-DNAT策略：

- 禁止集群外的流量进来
- 但允许访问特定NodePort。

这里我们用pre-DNAT策略而不是普通的主机端点策略，是因为：

1. 我们不管它要干什么，就想对外部流量一刀切——比如访问本地的一个Pod，或者是另一个节点上的Pod，再或者是本地主机上的某个进程。Pre-DNAT策略适用于以上所有场景，而普通的主机端点策略无法限制访问本地Pod的流量。
2. 我们想针对暴露出去的NodePort来编写策略，而不是那种内部端口。ingress节点上的kube-proxy会使用DNAT将NodePort端口和IP地址改成Service对应的某个Pod的信息。所以我们的策略需要在DNAT*之前*生效——也就是说它必须得是一个pre-DNAT策略。

> 注意：本文我们用的都是有命名的主机端点，比如说主机端点的`interfaceName`设置成了特定的接口名。如果设置的是`interfaceName: "*"`，那么这里讲的东西就不管用了。