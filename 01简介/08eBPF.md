# eBPF

> 这里包含了一些相关的背景知识，不仅限于Calico。

eBPF是Linux内核的一个特性，允许将一些小程序快速且安全的加载到内核中，个性化其中的操作。

在这里你会学习到：

- eBPF的背景。
- eBPF的各种用法。
- Calico在eBPF数据面中是如何利用eBPF的。

## 什么是eBPF？

eBPF是嵌入到Linux内核中的一个虚拟机。它可以让小型程序加载到内核中，可以附加到钩子上，事件发生时就可以触发。这样就可以对内核的行为（有的时候是重度）个性化。虽然eBPF虚拟机对每种类型的钩子是一样的，但是钩子的能力可是相当多的。因为在内核中加载程序是非常危险的；内核都是通过一个非常严格的静态校验器来执行所有的程序；这个校验器将程序沙箱化了，保证它只能访问允许的内存，保证它必须会快速的结束。

## 为什么要叫eBPF？

eBPF指的是“extended Berkeley Packet Filter”。Berkeley Packet Filter是一个更早且更专业的虚拟机，专用于数据包过滤。像`tcpdump`这种工具就使用了“经典的”BPF虚拟机，选出应该被发往用户空间进行分析的数据包。eBPF是BPF的一个极大的扩展版本，广泛适用于内核场景中。虽然名字没什么变化，但eBPF能干的事儿可比数据包过滤要多得多。

## 它能干啥？

### eBPF程序的分类

内核中有几个典型的钩子，eBPF程序可以附加上去。eBPF程序的能力极大依赖于它所依附的钩子：

- **跟踪**
- **留空**
- **XDP**