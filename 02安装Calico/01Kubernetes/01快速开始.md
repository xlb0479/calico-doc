# 在Kubernetes上快速安装Calico

## 主旨

本文旨在带你快速在一个单节点Kuberenetes集群上安装Calico，大约需要15分钟。

## 价值

通过快速安装，迅速且轻而易举地了解到Calico的特性。如果要部署一个生产环境的集群，请见[在Kuberenetes上安装Calico](00Kubernetes.md)。

## 开始之前

- 确保已有一个满足下列要求的Linux主机：
    - x86-64、arm64、ppc64le、或s390x处理器
    - 2CPU
    - 2GB RAM
    - 10GB可用磁盘空间
    - RHEL 7.x+、CentOS 7.x+、Ubuntu 16.04+、或Debian 9.x+
- 确保Calico可以操作主机上的`cali`和`tunl`接口。如果主机上有NetworkManager，参见[配置NetworkManager](../../05运维/10排错/01排错及诊断.md#配置networkmanager)。

## 概念

### 基于Operator的安装

这里我们使用Tigera operator进行快速安装。Operator为Calico提供整个生命周期的管理，通过Kubernetes API暴露出来，定义成了一个自定义资源（CRD）。

> 注意：不用Operator，直接用Kubernetes的manifest也可以安装Calico。对于不使用Tigera operator的平台和说明文档，可能会有一些步骤和Kubernetes资源跟这里讲的不一样。

## 怎么弄

[Calico部署选项](../../Calico%E9%83%A8%E7%BD%B2%E9%80%89%E9%A1%B9.md)

### 创建一个单节点Kubernetes集群

1. [参照Kubernetes说明安装kubeadm](https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/)

> 注意：安装完kubeadm之后，不要关闭或重启主机。直接按照下面的步骤继续。

2. 用一个带sudo权限的普通用户，打开一个安装了kubeadm的主机终端。
3. 用下面的命令安装master。

```shell
sudo kubeadm init --pod-network-cidr=192.168.0.0/16
```

> 注意：如果你的网络中已经用了192.168.0.0/16了，那就要换一个Pod网络CIDR，在上面的命令中替换192.168.0.0/16即可。

4. 执行下面的命令，配置kubectl（执行`kubeadm init`之后也会打印出这些命令）。

```shell
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
```